<!-- Page Favoris - N√¥t√©a -->
<div class="favoris-page py-5">
  
  <!-- Toast Notification -->
  <div class="toast-notification" 
       [class.show]="showToast"
       [class.success]="toastType === 'success'"
       [class.error]="toastType === 'error'"
       [class.info]="toastType === 'info'"
       (click)="hideToast()">
    <div class="toast-icon">
      <span *ngIf="toastType === 'success'">‚úì</span>
      <span *ngIf="toastType === 'error'">‚úï</span>
      <span *ngIf="toastType === 'info'">‚Ñπ</span>
    </div>
    <span class="toast-message">{{ toastMessage }}</span>
  </div>

  <div class="container">
    
    <!-- Header -->
    <div class="text-center mb-5">
      <h1 class="h2 font-heading text-gold-light mb-2" style="letter-spacing: 2px;">Mes Favoris</h1>
      <p class="text-muted-custom" *ngIf="isLoggedIn && favorites.length > 0">
        {{ favorites.length }} parfum{{ favorites.length > 1 ? 's' : '' }} dans votre collection
      </p>
    </div>

    <!-- Loading State -->
    <div class="text-center py-5" *ngIf="loading">
      <div class="loading-spinner mx-auto mb-3"></div>
      <p class="text-muted-custom">Chargement de vos favoris...</p>
    </div>

    <!-- Not Logged In -->
    <div class="text-center py-5" *ngIf="!loading && !isLoggedIn">
      <div class="display-1 mb-4 opacity-50">üîê</div>
      <h2 class="h4 font-heading text-gold-light mb-3">Connexion requise</h2>
      <p class="text-muted-custom mb-4">Connectez-vous pour acc√©der √† vos favoris</p>
      <a routerLink="/login" class="btn btn-primary px-4">Se connecter</a>
    </div>

    <!-- No Favorites -->
    <div class="text-center py-5" *ngIf="!loading && isLoggedIn && favorites.length === 0">
      <div class="display-1 mb-4 opacity-50">‚ô°</div>
      <h2 class="h4 font-heading text-gold-light mb-3">Aucun favori</h2>
      <p class="text-muted-custom mb-4">Explorez notre catalogue et ajoutez vos parfums pr√©f√©r√©s</p>
      <a routerLink="/ListParfums" class="btn btn-primary px-4">D√©couvrir les parfums</a>
    </div>

    <!-- Favorites Grid -->
    <div class="row g-4" *ngIf="!loading && isLoggedIn && favorites.length > 0">
      <div class="col-6 col-md-4 col-lg-3" *ngFor="let product of favorites">
        <div class="card product-card h-100" (click)="openProduct(product)">
          
          <!-- Badges -->
          <div class="position-absolute top-0 start-0 p-2 d-flex flex-column gap-1" style="z-index: 2;">
            <span class="badge bg-gold" *ngIf="product.isNew">Nouveau</span>
            <span class="badge bg-amber" *ngIf="product.isSephoraExclusive">Exclusif</span>
            <span class="badge" style="background: rgba(180, 80, 100, 0.9); color: #faf3e8;" 
                  *ngIf="product.isLimitedEdition">√âdition Limit√©e</span>
          </div>
          
          <!-- Remove Button -->
          <button class="favorite-btn active" 
                  (click)="removeFavorite($event, product)"
                  title="Retirer des favoris">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
          </button>
          
          <!-- Image -->
          <div class="product-image">
            <img [src]="product.heroImage" [alt]="product.displayName" loading="lazy" class="card-img-top">
          </div>
          
          <!-- Info -->
          <div class="card-body">
            <p class="product-brand mb-1">{{ product.brandName }}</p>
            <h5 class="product-name card-title">{{ product.displayName }}</h5>
            
            <!-- Rating -->
            <div class="d-flex align-items-center gap-2 mb-2" *ngIf="product.rating && product.rating !== '0'">
              <div class="stars">
                <span *ngFor="let star of getStars(product.rating)" 
                      class="star" 
                      [class.full]="star === 'full'"
                      [class.half]="star === 'half'">‚òÖ</span>
              </div>
              <span class="text-gold-light small fw-semibold">{{ formatRating(product.rating) }}</span>
              <span class="text-muted-custom small" *ngIf="product.reviews">({{ product.reviews }})</span>
            </div>
            
            <!-- Price -->
            <p class="product-price mb-1">{{ formatPrice(product.price) }}</p>
            
            <!-- Added Date -->
            <p class="text-muted-custom small fst-italic mb-0">
              Ajout√© le {{ formatDate(product.addedAt) }}
            </p>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
